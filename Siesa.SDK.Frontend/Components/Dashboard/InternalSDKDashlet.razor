@using Siesa.SDK.Frontend.Components.Visualization 
@using Microsoft.Extensions.DependencyInjection  
@using Microsoft.AspNetCore.Components 
@inject IServiceProvider ServiceProvider

<div class="row whcm_row">
    <div class="d-flex w-100 whcm_multi_panel_full">
        <div class="whcm_home_recent  col-12 col-sm-6 col-md-6 col-lg-6 py-3">
            <div class="sdk-dashlet">
                <ErrorBoundary @ref="errorBoundary">
                    <ChildContent>
                        @GetDashlet()?.Title
                        <DynamicComponent Type="@Item" @ref="DynamicComponentRef" />
                    </ChildContent> 
                    <ErrorContent Context="Exception" >
                        <p>ocurrio un error</p>
                    </ErrorContent>
                </ErrorBoundary>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter]
    public Type Item { get; set; }

    private Microsoft.AspNetCore.Components.DynamicComponent DynamicComponentRef { get; set; }
    private ErrorBoundary? errorBoundary;


    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
    }

    private SDKDashlet GetDashlet()
    {
        if(DynamicComponentRef == null)
        {
            return null;
        }

        return DynamicComponentRef.Instance as SDKDashlet;
    }

    /*private string GetWidth()
    {
        return Item.Width switch
        {
            SDKDashletWidth.Full => "100%",
            SDKDashletWidth.Half => "50%",
            SDKDashletWidth.Third => "33.33%",
            SDKDashletWidth.Quarter => "25%",
            _ => "25%"
        };
    }*/
}